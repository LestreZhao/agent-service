---
description: 
globs: 
alwaysApply: false
---
# FusionAI æ™ºèƒ½ä½“å·¥ä½œæµå›¾ç”Ÿæˆå™¨è§„åˆ™

## å·¥å…·æ¦‚è¿°

[scripts/generate_workflow_diagram.py](mdc:scripts/generate_workflow_diagram.py) æ˜¯ä¸“é—¨ä¸ºFusionAIé¡¹ç›®åˆ›å»ºçš„æ™ºèƒ½ä½“å·¥ä½œæµå¯è§†åŒ–å·¥å…·ã€‚

### ä¸»è¦åŠŸèƒ½

1. **è‡ªåŠ¨åˆ†æå·¥ä½œæµç»“æ„** - è§£æ [src/graph/](mdc:src/graph) ç›®å½•ä¸­çš„èŠ‚ç‚¹å’Œè¾¹å®šä¹‰
2. **å¤šæ ¼å¼è¾“å‡º** - æ”¯æŒPNGã€SVGã€HTMLäº¤äº’å¼ã€Mermaidæ ¼å¼
3. **è‡ªåŠ¨åˆ·æ–°æ¨¡å¼** - ç›‘æ§æºä»£ç å˜åŒ–ï¼Œå®æ—¶æ›´æ–°æµç¨‹å›¾
4. **è¯¦ç»†åˆ†ææŠ¥å‘Š** - ç”Ÿæˆå·¥ä½œæµæ‘˜è¦å’Œç»Ÿè®¡ä¿¡æ¯

## å¿«é€Ÿä½¿ç”¨

### åŸºç¡€å‘½ä»¤

```bash
# ç”Ÿæˆæ‰€æœ‰æ ¼å¼çš„æµç¨‹å›¾
python3 scripts/generate_workflow_diagram.py

# åªç”Ÿæˆç‰¹å®šæ ¼å¼
python3 scripts/generate_workflow_diagram.py --format png
python3 scripts/generate_workflow_diagram.py --format mermaid

# ç”Ÿæˆåè‡ªåŠ¨æ‰“å¼€
python3 scripts/generate_workflow_diagram.py --open

# ç”Ÿæˆå·¥ä½œæµæ‘˜è¦
python3 scripts/generate_workflow_diagram.py --summary
```

### å¼€å‘æ¨¡å¼

```bash
# å¯åŠ¨è‡ªåŠ¨åˆ·æ–°æ¨¡å¼ï¼ˆæ¨èå¼€å‘æ—¶ä½¿ç”¨ï¼‰
python3 scripts/generate_workflow_diagram.py --auto-refresh

# è‡ªå®šä¹‰åˆ·æ–°é—´éš”
python3 scripts/generate_workflow_diagram.py --auto-refresh --interval 3
```

## è¾“å‡ºæ–‡ä»¶

ç”Ÿæˆçš„æ–‡ä»¶ä½äº [docs/diagrams/](mdc:docs/diagrams) ç›®å½•ï¼š

- `fusionai_workflow.png` - é«˜è´¨é‡PNGæµç¨‹å›¾
- `fusionai_workflow.svg` - å¯ç¼©æ”¾çŸ¢é‡å›¾
- `fusionai_workflow_interactive.html` - äº¤äº’å¼HTMLå›¾è¡¨
- `fusionai_workflow.mmd` - Mermaidå›¾è¡¨ä»£ç 
- `fusionai_workflow_matplotlib.png` - Matplotlibç‰ˆæœ¬

å·¥ä½œæµæ‘˜è¦æŠ¥å‘Šï¼š [docs/workflow_summary.md](mdc:docs/workflow_summary.md)

## ä¾èµ–å®‰è£…

### è‡ªåŠ¨å®‰è£…
```bash
python3 scripts/setup_diagram_dependencies.py
```

### æ‰‹åŠ¨å®‰è£…
```bash
# Pythonä¾èµ–
uv add graphviz matplotlib networkx plotly watchdog

# ç³»ç»Ÿçº§Graphviz (macOS)
brew install graphviz
```

## åˆ†ææœºåˆ¶

### å·¥ä½œæµç»“æ„åˆ†æ

å·¥å…·è‡ªåŠ¨åˆ†æä»¥ä¸‹æ–‡ä»¶ä»¥æ„å»ºæµç¨‹å›¾ï¼š

1. **[src/graph/builder.py](mdc:src/graph/builder.py)** - èŠ‚ç‚¹å®šä¹‰å’ŒåŸºç¡€è¿æ¥
2. **[src/graph/nodes.py](mdc:src/graph/nodes.py)** - èŠ‚ç‚¹å®ç°å’ŒåŠ¨æ€è·¯ç”±
3. **[src/config/__init__.py](mdc:src/config/__init__.py)** - å›¢é˜Ÿæˆå‘˜é…ç½®
4. **[src/agents/](mdc:src/agents)** - æ™ºèƒ½ä½“å·¥å…·ç»‘å®šä¿¡æ¯

### èŠ‚ç‚¹ç±»å‹è¯†åˆ«

è‡ªåŠ¨è¯†åˆ«çš„èŠ‚ç‚¹ç±»å‹ï¼š

- **å…¥å£èŠ‚ç‚¹** (coordinator) - ç”¨æˆ·äº¤äº’æ¥å£
- **è§„åˆ’èŠ‚ç‚¹** (planner) - ä»»åŠ¡è§„åˆ’å’Œåˆ†è§£  
- **ç›‘ç£èŠ‚ç‚¹** (supervisor) - æµç¨‹æ§åˆ¶ä¸­å¿ƒ
- **æ‰§è¡ŒèŠ‚ç‚¹** (researcher, coder, browserç­‰) - å…·ä½“ä»»åŠ¡æ‰§è¡Œ
- **è¾“å‡ºèŠ‚ç‚¹** (reporter) - ç»“æœæ•´ç†å’ŒæŠ¥å‘Š

### è·¯ç”±åˆ†æ

- **ç›´æ¥è¾¹** - å›ºå®šçš„èŠ‚ç‚¹è¿æ¥å…³ç³»
- **æ¡ä»¶è¾¹** - supervisoråŠ¨æ€è·¯ç”±åˆ°ä¸åŒæ™ºèƒ½ä½“

## å¼€å‘é›†æˆ

### åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨

1. **ä¿®æ”¹å·¥ä½œæµåç«‹å³æ›´æ–°å›¾è¡¨**
   ```bash
   python3 scripts/generate_workflow_diagram.py --format png
   ```

2. **å¼€å‘æ—¶æŒç»­ç›‘æ§**
   ```bash
   python3 scripts/generate_workflow_diagram.py --auto-refresh
   ```

3. **æ–‡æ¡£é›†æˆ**
   åœ¨READMEæˆ–æ–‡æ¡£ä¸­å¼•ç”¨ç”Ÿæˆçš„å›¾è¡¨ï¼š
   ```markdown
   ![FusionAIå·¥ä½œæµ](mdc:docs/diagrams/fusionai_workflow.png)
   ```

### CI/CDé›†æˆ

```yaml
# GitHub Actionsç¤ºä¾‹
- name: Generate Workflow Diagrams  
  run: |
    python3 scripts/setup_diagram_dependencies.py
    python3 scripts/generate_workflow_diagram.py --format all
    
- name: Commit Updated Diagrams
  run: |
    git add docs/diagrams/
    git commit -m "Update workflow diagrams" || exit 0
```

## è‡ªå®šä¹‰å’Œæ‰©å±•

### ä¿®æ”¹èŠ‚ç‚¹é¢œè‰²

ç¼–è¾‘ [scripts/generate_workflow_diagram.py](mdc:scripts/generate_workflow_diagram.py) ä¸­çš„é¢œè‰²é…ç½®ï¼š

```python
node_colors = {
    "å…¥å£èŠ‚ç‚¹": "#E3F2FD",    # æµ…è“è‰²
    "è§„åˆ’èŠ‚ç‚¹": "#F3E5F5",    # æµ…ç´«è‰²
    "ç›‘ç£èŠ‚ç‚¹": "#FFF3E0",    # æµ…æ©™è‰²
    "æ‰§è¡ŒèŠ‚ç‚¹": "#E8F5E8",    # æµ…ç»¿è‰²
    "è¾“å‡ºèŠ‚ç‚¹": "#FFEBEE"     # æµ…çº¢è‰²
}
```

### æ·»åŠ æ–°çš„åˆ†æåŠŸèƒ½

æ‰©å±• `WorkflowAnalyzer` ç±»ï¼š

```python
def _analyze_custom_feature(self, workflow_info):
    """è‡ªå®šä¹‰åˆ†æåŠŸèƒ½"""
    # æ·»åŠ ç‰¹å®šçš„åˆ†æé€»è¾‘
    pass
```

### æ–°å¢è¾“å‡ºæ ¼å¼

æ‰©å±• `DiagramGenerator` ç±»ï¼š

```python
def generate_custom_format(self):
    """è‡ªå®šä¹‰æ ¼å¼ç”Ÿæˆå™¨"""
    # å®ç°æ–°çš„è¾“å‡ºæ ¼å¼
    pass
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç¼ºå°‘ä¾èµ–åŒ…**
   ```bash
   python3 scripts/setup_diagram_dependencies.py
   ```

2. **Graphvizæœªå®‰è£…**
   ```bash
   brew install graphviz  # macOS
   sudo apt-get install graphviz  # Ubuntu
   ```

3. **ä¸­æ–‡å­—ä½“æ˜¾ç¤ºé—®é¢˜**
   - Matplotlibä¼šæ˜¾ç¤ºä¸­æ–‡å­—ä½“è­¦å‘Šï¼Œä½†ä¸å½±å“PNGç”Ÿæˆ
   - å»ºè®®ä½¿ç”¨SVGæˆ–HTMLæ ¼å¼è·å¾—æ›´å¥½çš„ä¸­æ–‡æ”¯æŒ

4. **å¯¼å…¥é”™è¯¯**
   - ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œè„šæœ¬
   - æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒæ˜¯å¦æ­£ç¡®æ¿€æ´»

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
python3 scripts/generate_workflow_diagram.py --verbose

# æµ‹è¯•å•ä¸ªæ ¼å¼
python3 scripts/generate_workflow_diagram.py --format mermaid
```

## æœ€ä½³å®è·µ

1. **å¼€å‘æ—¶ä½¿ç”¨è‡ªåŠ¨åˆ·æ–°**
   ```bash
   python3 scripts/generate_workflow_diagram.py --auto-refresh
   ```

2. **æ–‡æ¡£ä½¿ç”¨PNGæ ¼å¼**
   - é€‚åˆåµŒå…¥READMEå’Œæ–‡æ¡£
   - è·¨å¹³å°å…¼å®¹æ€§å¥½

3. **æ¼”ç¤ºä½¿ç”¨HTMLäº¤äº’å¼**
   - æ”¯æŒæ‚¬åœæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
   - é€‚åˆåœ¨çº¿æ¼”ç¤ºå’ŒåŸ¹è®­

4. **ä»£ç æ–‡æ¡£ä½¿ç”¨Mermaid**
   - å¯ä»¥ç›´æ¥åµŒå…¥Markdown
   - GitHubåŸç”Ÿæ”¯æŒæ¸²æŸ“

5. **å®šæœŸæ›´æ–°å›¾è¡¨**
   - åœ¨ä¿®æ”¹å·¥ä½œæµååŠæ—¶ç”Ÿæˆæ–°å›¾è¡¨
   - å°†å›¾è¡¨çº³å…¥ç‰ˆæœ¬æ§åˆ¶

## ç›¸å…³æ–‡ä»¶

- **ä½¿ç”¨æ–‡æ¡£**: [docs/workflow_diagram_generator.md](mdc:docs/workflow_diagram_generator.md)
- **ç”Ÿæˆè„šæœ¬**: [scripts/generate_workflow_diagram.py](mdc:scripts/generate_workflow_diagram.py)
- **ä¾èµ–å®‰è£…**: [scripts/setup_diagram_dependencies.py](mdc:scripts/setup_diagram_dependencies.py)
- **è¾“å‡ºç›®å½•**: [docs/diagrams/](mdc:docs/diagrams)
- **å·¥ä½œæµæºç **: [src/graph/](mdc:src/graph)

---

**ğŸ’¡ æç¤º**: è¿™ä¸ªå·¥å…·æ˜¯ä¸“é—¨ä¸ºFusionAIé¡¹ç›®è®¾è®¡çš„ï¼Œèƒ½å¤Ÿå‡†ç¡®åæ˜ å½“å‰çš„æ™ºèƒ½ä½“å·¥ä½œæµç»“æ„ã€‚å»ºè®®åœ¨ä¿®æ”¹å·¥ä½œæµä»£ç ååŠæ—¶æ›´æ–°å›¾è¡¨ï¼Œä¿æŒæ–‡æ¡£ä¸ä»£ç çš„åŒæ­¥ã€‚
